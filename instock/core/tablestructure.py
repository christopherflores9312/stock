#!/usr/bin/env python3
# -*- coding: utf-8 -*-

from sqlalchemy import DATE, NVARCHAR, FLOAT, BIGINT, SmallInteger, DATETIME
from sqlalchemy.dialects.mysql import BIT
import talib as tl
from instock.core.strategy import enter
from instock.core.strategy import turtle_trade
from instock.core.strategy import climax_limitdown
from instock.core.strategy import low_atr
from instock.core.strategy import backtrace_ma250
from instock.core.strategy import breakthrough_platform
from instock.core.strategy import parking_apron
from instock.core.strategy import low_backtrace_increase
from instock.core.strategy import keep_increasing
from instock.core.strategy import high_tight_flag

__author__ = 'myh '
__date__ = '2023/3/10 '

RATE_FIELDS_COUNT = 100  # Number of fields for N-day rate of return, i.e., N value

TABLE_CN_STOCK_ATTENTION = {'name': 'cn_stock_attention', 'cn': 'My Watchlist',
                            'columns': {'datetime': {'type': DATETIME, 'cn': 'Date', 'size': 0},
                                        'code': {'type': NVARCHAR(6), 'cn': 'Code', 'size': 60}}}

TABLE_CN_ETF_SPOT = {'name': 'cn_etf_spot', 'cn': 'Daily ETF Data',
                     'columns': {'date': {'type': DATE, 'cn': 'Date', 'size': 0},
                                 'code': {'type': NVARCHAR(6), 'cn': 'Code', 'size': 60},
                                 'name': {'type': NVARCHAR(20), 'cn': 'Name', 'size': 120},
                                 'new_price': {'type': FLOAT, 'cn': 'Latest Price', 'size': 70},
                                 'change_rate': {'type': FLOAT, 'cn': 'Change Rate', 'size': 70},
                                 'ups_downs': {'type': FLOAT, 'cn': 'Change Amount', 'size': 70},
                                 'volume': {'type': BIGINT, 'cn': 'Volume', 'size': 90},
                                 'deal_amount': {'type': BIGINT, 'cn': 'Deal Amount', 'size': 100},
                                 'open_price': {'type': FLOAT, 'cn': 'Opening Price', 'size': 70},
                                 'high_price': {'type': FLOAT, 'cn': 'Highest Price', 'size': 70},
                                 'low_price': {'type': FLOAT, 'cn': 'Lowest Price', 'size': 70},
                                 'pre_close_price': {'type': FLOAT, 'cn': 'Previous Close Price', 'size': 70},
                                 'turnoverrate': {'type': FLOAT, 'cn': 'Turnover Rate', 'size': 70},
                                 'total_market_cap': {'type': BIGINT, 'cn': 'Total Market Cap', 'size': 120},
                                 'free_cap': {'type': BIGINT, 'cn': 'Free Market Cap', 'size': 120}}}

TABLE_CN_STOCK_SPOT = {'name': 'cn_stock_spot', 'cn': 'Daily Stock Data',
                       'columns': {'date': {'type': DATE, 'cn': 'Date', 'size': 0},
                                   'code': {'type': NVARCHAR(6), 'cn': 'Code', 'size': 60},
                                   'name': {'type': NVARCHAR(20), 'cn': 'Name', 'size': 70},
                                   'new_price': {'type': FLOAT, 'cn': 'Latest Price', 'size': 70},
                                   'change_rate': {'type': FLOAT, 'cn': 'Change Rate', 'size': 70},
                                   'ups_downs': {'type': FLOAT, 'cn': 'Change Amount', 'size': 70},
                                   'volume': {'type': BIGINT, 'cn': 'Volume', 'size': 90},
                                   'deal_amount': {'type': BIGINT, 'cn': 'Deal Amount', 'size': 100},
                                   'amplitude': {'type': FLOAT, 'cn': 'Amplitude', 'size': 70},
                                   'volume_ratio': {'type': FLOAT, 'cn': 'Volume Ratio', 'size': 70},
                                   'turnoverrate': {'type': FLOAT, 'cn': 'Turnover Rate', 'size': 70},
                                   'open_price': {'type': FLOAT, 'cn': 'Opening Price', 'size': 70},
                                   'high_price': {'type': FLOAT, 'cn': 'Highest Price', 'size': 70},
                                   'low_price': {'type': FLOAT, 'cn': 'Lowest Price', 'size': 70},
                                   'pre_close_price': {'type': FLOAT, 'cn': 'Previous Close Price', 'size': 70},
                                   'speed_increase': {'type': FLOAT, 'cn': 'Speed of Increase', 'size': 70},
                                   'speed_increase_5': {'type': FLOAT, 'cn': '5-Minute Change', 'size': 70},
                                   'speed_increase_60': {'type': FLOAT, 'cn': '60-Day Change Rate', 'size': 70},
                                   'speed_increase_all': {'type': FLOAT, 'cn': 'Year-to-Date Change Rate', 'size': 70},
                                   'dtsyl': {'type': FLOAT, 'cn': 'Dynamic Price-Earnings Ratio', 'size': 70},
                                   'pe9': {'type': FLOAT, 'cn': 'TTM Price-Earnings Ratio', 'size': 70},
                                   'pe': {'type': FLOAT, 'cn': 'Static Price-Earnings Ratio', 'size': 70},
                                   'pbnewmrq': {'type': FLOAT, 'cn': 'Price-to-Book Ratio', 'size': 70},
                                   'basic_eps': {'type': FLOAT, 'cn': 'Earnings Per Share', 'size': 70},
                                   'bvps': {'type': FLOAT, 'cn': 'Net Asset Value Per Share', 'size': 70},
                                   'per_capital_reserve': {'type': FLOAT, 'cn': 'Per Share Capital Reserve', 'size': 70},
                                   'per_unassign_profit': {'type': FLOAT, 'cn': 'Per Share Undistributed Profit', 'size': 70},
                                   'roe_weight': {'type': FLOAT, 'cn': 'Weighted ROE', 'size': 70},
                                   'sale_gpr': {'type': FLOAT, 'cn': 'Gross Profit Margin', 'size': 70},
                                   'debt_asset_ratio': {'type': FLOAT, 'cn': 'Debt-to-Asset Ratio', 'size': 70},
                                   'total_operate_income': {'type': BIGINT, 'cn': 'Operating Revenue', 'size': 120},
                                   'toi_yoy_ratio': {'type': FLOAT, 'cn': 'YoY Growth in Operating Revenue', 'size': 70},
                                   'parent_netprofit': {'type': BIGINT, 'cn': 'Net Profit Attributable to Parent Company', 'size': 110},
                                   'netprofit_yoy_ratio': {'type': FLOAT, 'cn': 'YoY Growth in Net Profit', 'size': 70},
                                   'report_date': {'type': DATE, 'cn': 'Reporting Period', 'size': 110},
                                   'total_shares': {'type': BIGINT, 'cn': 'Total Shares', 'size': 120},
                                   'free_shares': {'type': BIGINT, 'cn': 'Circulating Shares', 'size': 120},
                                   'total_market_cap': {'type': BIGINT, 'cn': 'Total Market Cap', 'size': 120},
                                   'free_cap': {'type': BIGINT, 'cn': 'Free Market Cap', 'size': 120},
                                   'industry': {'type': NVARCHAR(20), 'cn': 'Industry', 'size': 100},
                                   'listing_date': {'type': DATE, 'cn': 'Listing Date', 'size': 110}}}

TABLE_CN_STOCK_SPOT_BUY = {'name': 'cn_stock_spot_buy', 'cn': 'Fundamental Stock Selection',
                           'columns': TABLE_CN_STOCK_SPOT['columns'].copy()}

CN_STOCK_FUND_FLOW = ({'name': 'stock_individual_fund_flow_rank', 'cn': 'Today',
                       'columns': {'code': {'type': NVARCHAR(6), 'cn': 'Code', 'size': 60},
                                   'name': {'type': NVARCHAR(20), 'cn': 'Name', 'size': 70},
                                   'new_price': {'type': FLOAT, 'cn': 'Latest Price', 'size': 70},
                                   'change_rate': {'type': FLOAT, 'cn': 'Today’s Change Rate', 'size': 70},
                                   'fund_amount': {'type': BIGINT, 'cn': 'Today’s Net Fund Inflow', 'size': 100},
                                   'fund_rate': {'type': FLOAT, 'cn': 'Today’s Fund Inflow Percentage', 'size': 70},
                                   'fund_amount_super': {'type': BIGINT, 'cn': 'Today’s Net Super Large Orders', 'size': 100},
                                   'fund_rate_super': {'type': FLOAT, 'cn': 'Today’s Super Large Orders Percentage', 'size': 70},
                                   'fund_amount_large': {'type': BIGINT, 'cn': 'Today’s Net Large Orders', 'size': 100},
                                   'fund_rate_large': {'type': FLOAT, 'cn': 'Today’s Large Orders Percentage', 'size': 70},
                                   'fund_amount_medium': {'type': BIGINT, 'cn': 'Today’s Net Medium Orders', 'size': 100},
                                   'fund_rate_medium': {'type': FLOAT, 'cn': 'Today’s Medium Orders Percentage', 'size': 70},
                                   'fund_amount_small': {'type': BIGINT, 'cn': 'Today’s Net Small Orders', 'size': 100},
                                   'fund_rate_small': {'type': FLOAT, 'cn': 'Today’s Small Orders Percentage', 'size': 70}}},
                      {'name': 'stock_individual_fund_flow_rank', 'cn': '3-Day',
                       'columns': {'code': {'type': NVARCHAR(6), 'cn': 'Code', 'size': 60},
                                   'name': {'type': NVARCHAR(20), 'cn': 'Name', 'size': 70},
                                   'new_price': {'type': FLOAT, 'cn': 'Latest Price', 'size': 70},
                                   'change_rate_3': {'type': FLOAT, 'cn': '3-Day Change Rate', 'size': 70},
                                   'fund_amount_3': {'type': BIGINT, 'cn': '3-Day Net Fund Inflow', 'size': 100},
                                   'fund_rate_3': {'type': FLOAT, 'cn': '3-Day Fund Inflow Percentage', 'size': 70},
                                   'fund_amount_super_3': {'type': BIGINT, 'cn': '3-Day Net Super Large Orders', 'size': 100},
                                   'fund_rate_super_3': {'type': FLOAT, 'cn': '3-Day Super Large Orders Percentage', 'size': 70},
                                   'fund_amount_large_3': {'type': BIGINT, 'cn': '3-Day Net Large Orders', 'size': 100},
                                   'fund_rate_large_3': {'type': FLOAT, 'cn': '3-Day Large Orders Percentage', 'size': 70},
                                   'fund_amount_medium_3': {'type': BIGINT, 'cn': '3-Day Net Medium Orders', 'size': 100},
                                   'fund_rate_medium_3': {'type': FLOAT, 'cn': '3-Day Medium Orders Percentage', 'size': 70},
                                   'fund_amount_small_3': {'type': BIGINT, 'cn': '3-Day Net Small Orders', 'size': 100},
                                   'fund_rate_small_3': {'type': FLOAT, 'cn': '3-Day Small Orders Percentage', 'size': 70}}},
                      {'name': 'stock_individual_fund_flow_rank', 'cn': '5-Day',
                       'columns': {'code': {'type': NVARCHAR(6), 'cn': 'Code', 'size': 60},
                                   'name': {'type': NVARCHAR(20), 'cn': 'Name', 'size': 70},
                                   'new_price': {'type': FLOAT, 'cn': 'Latest Price', 'size': 70},
                                   'change_rate_5': {'type': FLOAT, 'cn': '5-Day Change Rate', 'size': 70},
                                   'fund_amount_5': {'type': BIGINT, 'cn': '5-Day Net Fund Inflow', 'size': 100},
                                   'fund_rate_5': {'type': FLOAT, 'cn': '5-Day Fund Inflow Percentage', 'size': 70},
                                   'fund_amount_super_5': {'type': BIGINT, 'cn': '5-Day Net Super Large Orders', 'size': 100},
                                   'fund_rate_super_5': {'type': FLOAT, 'cn': '5-Day Super Large Orders Percentage', 'size': 70},
                                   'fund_amount_large_5': {'type': BIGINT, 'cn': '5-Day Net Large Orders', 'size': 100},
                                   'fund_rate_large_5': {'type': FLOAT, 'cn': '5-Day Large Orders Percentage', 'size': 70},
                                   'fund_amount_medium_5': {'type': BIGINT, 'cn': '5-Day Net Medium Orders', 'size': 100},
                                   'fund_rate_medium_5': {'type': FLOAT, 'cn': '5-Day Medium Orders Percentage', 'size': 70},
                                   'fund_amount_small_5': {'type': BIGINT, 'cn': '5-Day Net Small Orders', 'size': 100},
                                   'fund_rate_small_5': {'type': FLOAT, 'cn': '5-Day Small Orders Percentage', 'size': 70}}},
                      {'name': 'stock_individual_fund_flow_rank', 'cn': '10-Day',
                       'columns': {'code': {'type': NVARCHAR(6), 'cn': 'Code', 'size': 60},
                                   'name': {'type': NVARCHAR(20), 'cn': 'Name', 'size': 70},
                                   'new_price': {'type': FLOAT, 'cn': 'Latest Price', 'size': 70},
                                   'change_rate_10': {'type': FLOAT, 'cn': '10-Day Change Rate', 'size': 70},
                                   'fund_amount_10': {'type': BIGINT, 'cn': '10-Day Net Fund Inflow', 'size': 100},
                                   'fund_rate_10': {'type': FLOAT, 'cn': '10-Day Fund Inflow Percentage', 'size': 70},
                                   'fund_amount_super_10': {'type': BIGINT, 'cn': '10-Day Net Super Large Orders', 'size': 100},
                                   'fund_rate_super_10': {'type': FLOAT, 'cn': '10-Day Super Large Orders Percentage', 'size': 70},
                                   'fund_amount_large_10': {'type': BIGINT, 'cn': '10-Day Net Large Orders', 'size': 100},
                                   'fund_rate_large_10': {'type': FLOAT, 'cn': '10-Day Large Orders Percentage', 'size': 70},
                                   'fund_amount_medium_10': {'type': BIGINT, 'cn': '10-Day Net Medium Orders', 'size': 100},
                                   'fund_rate_medium_10': {'type': FLOAT, 'cn': '10-Day Medium Orders Percentage', 'size': 70},
                                   'fund_amount_small_10': {'type': BIGINT, 'cn': '10-Day Net Small Orders', 'size': 100},
                                   'fund_rate_small_10': {'type': FLOAT, 'cn': '10-Day Small Orders Percentage', 'size': 70}}})

TABLE_CN_STOCK_FUND_FLOW = {'name': 'cn_stock_fund_flow', 'cn': 'Stock Fund Flow',
                            'columns': {'date': {'type': DATE, 'cn': 'Date', 'size': 0}}}
for cf in CN_STOCK_FUND_FLOW:
    TABLE_CN_STOCK_FUND_FLOW['columns'].update(cf['columns'].copy())

CN_STOCK_SECTOR_FUND_FLOW = (
    'Industry Fund Flow',
    'Concept Fund Flow',
    {
        'name': 'stock_sector_fund_flow_rank',
        'cn': 'Today',
        'columns': {
            'name': {'type': NVARCHAR(20), 'cn': 'Name', 'size': 70},
            'change_rate': {'type': FLOAT, 'cn': 'Today’s Change Rate', 'size': 70},
            'fund_amount': {'type': BIGINT, 'cn': 'Today’s Net Fund Inflow', 'size': 100},
            'fund_rate': {'type': FLOAT, 'cn': 'Today’s Fund Inflow Percentage', 'size': 70},
            'fund_amount_super': {'type': BIGINT, 'cn': 'Today’s Net Super Large Orders', 'size': 100},
            'fund_rate_super': {'type': FLOAT, 'cn': 'Today’s Super Large Orders Percentage', 'size': 70},
            'fund_amount_large': {'type': BIGINT, 'cn': 'Today’s Net Large Orders', 'size': 100},
            'fund_rate_large': {'type': FLOAT, 'cn': 'Today’s Large Orders Percentage', 'size': 70},
            'fund_amount_medium': {'type': BIGINT, 'cn': 'Today’s Net Medium Orders', 'size': 100},
            'fund_rate_medium': {'type': FLOAT, 'cn': 'Today’s Medium Orders Percentage', 'size': 70},
            'fund_amount_small': {'type': BIGINT, 'cn': 'Today’s Net Small Orders', 'size': 100},
            'fund_rate_small': {'type': FLOAT, 'cn': 'Today’s Small Orders Percentage', 'size': 70},
            'stock_name': {'type': NVARCHAR(20), 'cn': 'Today’s Largest Fund Inflow Stock', 'size': 70}
        }
    }
)


TABLE_CN_STOCK_FUND_FLOW_INDUSTRY = {
    'name': 'cn_stock_fund_flow_industry',
    'cn': 'Industry Fund Flow',
    'columns': {'date': {'type': DATE, 'cn': 'Date', 'size': 0}}
}

TABLE_CN_STOCK_FUND_FLOW_CONCEPT = {
    'name': 'cn_stock_fund_flow_concept',
    'cn': 'Concept Fund Flow',
    'columns': {'date': {'type': DATE, 'cn': 'Date', 'size': 0}}
}

# Iterate over the dictionaries in CN_STOCK_SECTOR_FUND_FLOW[1]
for cf in CN_STOCK_SECTOR_FUND_FLOW[1]:  # This is a tuple of dictionaries
    if 'columns' in cf:  # Ensure 'columns' exists in the current dictionary
        TABLE_CN_STOCK_FUND_FLOW_INDUSTRY['columns'].update(cf['columns'])
        TABLE_CN_STOCK_FUND_FLOW_CONCEPT['columns'].update(cf['columns'])


TABLE_CN_STOCK_BONUS = {'name': 'cn_stock_bonus', 'cn': 'Stock Bonus Distribution',
                        'columns': {'date': {'type': DATE, 'cn': 'Date', 'size': 0},
                                    'code': {'type': NVARCHAR(6), 'cn': 'Code', 'size': 60},
                                    'name': {'type': NVARCHAR(20), 'cn': 'Name', 'size': 70},
                                    'convertible_total_rate': {'type': FLOAT, 'cn': 'Convertible Total Ratio', 'size': 70},
                                    'convertible_rate': {'type': FLOAT, 'cn': 'Convertible Ratio', 'size': 70},
                                    'convertible_transfer_rate': {'type': FLOAT, 'cn': 'Convertible Transfer Ratio', 'size': 70},
                                    'bonusaward_rate': {'type': FLOAT, 'cn': 'Cash Dividend Ratio', 'size': 70},
                                    'bonusaward_yield': {'type': FLOAT, 'cn': 'Cash Dividend Yield', 'size': 70},
                                    'basic_eps': {'type': FLOAT, 'cn': 'Earnings Per Share', 'size': 70},
                                    'bvps': {'type': FLOAT, 'cn': 'Book Value Per Share', 'size': 70},
                                    'per_capital_reserve': {'type': FLOAT, 'cn': 'Capital Reserve Per Share', 'size': 70},
                                    'per_unassign_profit': {'type': FLOAT, 'cn': 'Unassigned Profit Per Share', 'size': 70},
                                    'netprofit_yoy_ratio': {'type': FLOAT, 'cn': 'YoY Net Profit Growth', 'size': 70},
                                    'total_shares': {'type': BIGINT, 'cn': 'Total Shares', 'size': 120},
                                    'plan_date': {'type': DATE, 'cn': 'Plan Announcement Date', 'size': 110},
                                    'record_date': {'type': DATE, 'cn': 'Equity Record Date', 'size': 110},
                                    'ex_dividend_date': {'type': DATE, 'cn': 'Ex-dividend Date', 'size': 110},
                                    'progress': {'type': NVARCHAR(50), 'cn': 'Plan Progress', 'size': 100},
                                    'report_date': {'type': DATE, 'cn': 'Latest Announcement Date', 'size': 110}}}

TABLE_CN_STOCK_TOP = {'name': 'cn_stock_top', 'cn': 'Stock Leaderboard',
                      'columns': {'date': {'type': DATE, 'cn': 'Date', 'size': 0},
                                  'code': {'type': NVARCHAR(6), 'cn': 'Code', 'size': 60},
                                  'name': {'type': NVARCHAR(20), 'cn': 'Name', 'size': 70},
                                  'ranking_times': {'type': FLOAT, 'cn': 'Number of Rankings', 'size': 70},
                                  'sum_buy': {'type': FLOAT, 'cn': 'Total Buy Amount', 'size': 100},
                                  'sum_sell': {'type': FLOAT, 'cn': 'Total Sell Amount', 'size': 100},
                                  'net_amount': {'type': FLOAT, 'cn': 'Net Amount', 'size': 100},
                                  'buy_seat': {'type': FLOAT, 'cn': 'Number of Buy Seats', 'size': 100},
                                  'sell_seat': {'type': FLOAT, 'cn': 'Number of Sell Seats', 'size': 100}}}

TABLE_CN_STOCK_BLOCKTRADE = {'name': 'cn_stock_blocktrade', 'cn': 'Stock Block Trade',
                             'columns': {'date': {'type': DATE, 'cn': 'Date', 'size': 0},
                                         'code': {'type': NVARCHAR(6), 'cn': 'Code', 'size': 60},
                                         'name': {'type': NVARCHAR(20), 'cn': 'Name', 'size': 70},
                                         'new_price': {'type': FLOAT, 'cn': 'Closing Price', 'size': 70},
                                         'change_rate': {'type': FLOAT, 'cn': 'Change Rate', 'size': 70},
                                         'average_price': {'type': FLOAT, 'cn': 'Average Price', 'size': 70},
                                         'overflow_rate': {'type': FLOAT, 'cn': 'Overflow Rate', 'size': 120},
                                         'trade_number': {'type': FLOAT, 'cn': 'Number of Trades', 'size': 70},
                                         'sum_volume': {'type': FLOAT, 'cn': 'Total Volume', 'size': 100},
                                         'sum_turnover': {'type': FLOAT, 'cn': 'Total Turnover', 'size': 100},
                                         'turnover_market_rate': {'type': FLOAT, 'cn': 'Turnover Percentage of Market Value',
                                                                  'size': 120}}}

CN_STOCK_HIST_DATA = {'name': 'fund_etf_hist_em', 'cn': 'Fund Historical Data Database',
                      'columns': {'date': {'type': DATE, 'cn': 'Date'},
                                  'open': {'type': FLOAT, 'cn': 'Open'},
                                  'close': {'type': FLOAT, 'cn': 'Close'},
                                  'high': {'type': FLOAT, 'cn': 'High'},
                                  'low': {'type': FLOAT, 'cn': 'Low'},
                                  'volume': {'type': FLOAT, 'cn': 'Volume'},
                                  'amount': {'type': FLOAT, 'cn': 'Amount'},
                                  'amplitude': {'type': FLOAT, 'cn': 'Amplitude'},
                                  'quote_change': {'type': FLOAT, 'cn': 'Change Rate'},
                                  'ups_downs': {'type': FLOAT, 'cn': 'Change Amount'},
                                  'turnover': {'type': FLOAT, 'cn': 'Turnover Rate'}}}

TABLE_CN_STOCK_FOREIGN_KEY = {'name': 'cn_stock_foreign_key', 'cn': 'Stock Foreign Key',
                              'columns': {'date': {'type': DATE, 'cn': 'Date', 'size': 0},
                                          'code': {'type': NVARCHAR(6), 'cn': 'Code', 'size': 60},
                                          'name': {'type': NVARCHAR(20), 'cn': 'Name', 'size': 70}}}

TABLE_CN_STOCK_BACKTEST_DATA = {'name': 'cn_stock_backtest_data', 'cn': 'Stock Backtest Data',
                                'columns': {'rate_%s' % i: {'type': FLOAT, 'cn': '%s-Day Yield Rate' % i, 'size': 100} for i in
                                            range(1, RATE_FIELDS_COUNT + 1, 1)}}

STOCK_STATS_DATA = {'name': 'calculate_indicator', 'cn': 'Stock Statistics/Indicator Calculation Assistant Library',
                    'columns': {'close': {'type': FLOAT, 'cn': 'Price', 'size': 0},
                                'macd': {'type': FLOAT, 'cn': 'dif', 'size': 70},
                                'macds': {'type': FLOAT, 'cn': 'macd', 'size': 70},
                                'macdh': {'type': FLOAT, 'cn': 'histogram', 'size': 70},
                                'kdjk': {'type': FLOAT, 'cn': 'kdjk', 'size': 70},
                                'kdjd': {'type': FLOAT, 'cn': 'kdjd', 'size': 70},
                                'kdjj': {'type': FLOAT, 'cn': 'kdjj', 'size': 70},
                                'boll_ub': {'type': FLOAT, 'cn': 'boll upper band', 'size': 70},
                                'boll': {'type': FLOAT, 'cn': 'boll', 'size': 70},
                                'boll_lb': {'type': FLOAT, 'cn': 'boll lower band', 'size': 70},
                                'trix': {'type': FLOAT, 'cn': 'trix', 'size': 70},
                                'trix_20_sma': {'type': FLOAT, 'cn': 'trma', 'size': 70},
                                'tema': {'type': FLOAT, 'cn': 'tema', 'size': 70},
                                'cr': {'type': FLOAT, 'cn': 'cr', 'size': 70},
                                'cr-ma1': {'type': FLOAT, 'cn': 'cr-ma1', 'size': 70},
                                'cr-ma2': {'type': FLOAT, 'cn': 'cr-ma2', 'size': 70},
                                'cr-ma3': {'type': FLOAT, 'cn': 'cr-ma3', 'size': 70},
                                'rsi_6': {'type': FLOAT, 'cn': 'rsi_6', 'size': 70},
                                'rsi_12': {'type': FLOAT, 'cn': 'rsi_12', 'size': 70},
                                'rsi': {'type': FLOAT, 'cn': 'rsi', 'size': 70},
                                'rsi_24': {'type': FLOAT, 'cn': 'rsi_24', 'size': 70},
                                'vr': {'type': FLOAT, 'cn': 'vr', 'size': 70},
                                'vr_6_sma': {'type': FLOAT, 'cn': 'mavr', 'size': 70},
                                'roc': {'type': FLOAT, 'cn': 'roc', 'size': 70},
                                'rocma': {'type': FLOAT, 'cn': 'rocma', 'size': 70},
                                'rocema': {'type': FLOAT, 'cn': 'rocema', 'size': 70},
                                'pdi': {'type': FLOAT, 'cn': 'pdi', 'size': 70},
                                'mdi': {'type': FLOAT, 'cn': 'mdi', 'size': 70},
                                'dx': {'type': FLOAT, 'cn': 'dx', 'size': 70},
                                'adx': {'type': FLOAT, 'cn': 'adx', 'size': 70},
                                'adxr': {'type': FLOAT, 'cn': 'adxr', 'size': 70},
                                'wr_6': {'type': FLOAT, 'cn': 'wr_6', 'size': 70},
                                'wr_10': {'type': FLOAT, 'cn': 'wr_10', 'size': 70},
                                'wr_14': {'type': FLOAT, 'cn': 'wr_14', 'size': 70},
                                'cci': {'type': FLOAT, 'cn': 'cci', 'size': 70},
                                'cci_84': {'type': FLOAT, 'cn': 'cci_84', 'size': 70},
                                'tr': {'type': FLOAT, 'cn': 'tr', 'size': 70},
                                'atr': {'type': FLOAT, 'cn': 'atr', 'size': 70},
                                'dma': {'type': FLOAT, 'cn': 'dma', 'size': 70},
                                'dma_10_sma': {'type': FLOAT, 'cn': 'ama', 'size': 70},
                                'obv': {'type': FLOAT, 'cn': 'obv', 'size': 70},
                                'sar': {'type': FLOAT, 'cn': 'sar', 'size': 70},
                                'psy': {'type': FLOAT, 'cn': 'psy', 'size': 70},
                                'psyma': {'type': FLOAT, 'cn': 'psyma', 'size': 70},
                                'br': {'type': FLOAT, 'cn': 'br', 'size': 70},
                                'ar': {'type': FLOAT, 'cn': 'ar', 'size': 70},
                                'emv': {'type': FLOAT, 'cn': 'emv', 'size': 70},
                                'emva': {'type': FLOAT, 'cn': 'emva', 'size': 70},
                                'bias': {'type': FLOAT, 'cn': 'bias', 'size': 70},
                                'mfi': {'type': FLOAT, 'cn': 'mfi', 'size': 70},
                                'mfisma': {'type': FLOAT, 'cn': 'mfisma', 'size': 70},
                                'vwma': {'type': FLOAT, 'cn': 'vwma', 'size': 70},
                                'mvwma': {'type': FLOAT, 'cn': 'mvwma', 'size': 70},
                                'ppo': {'type': FLOAT, 'cn': 'ppo', 'size': 70},
                                'ppos': {'type': FLOAT, 'cn': 'ppos', 'size': 70},
                                'ppoh': {'type': FLOAT, 'cn': 'ppoh', 'size': 70},
                                'wt1': {'type': FLOAT, 'cn': 'wt1', 'size': 70},
                                'wt2': {'type': FLOAT, 'cn': 'wt2', 'size': 70},
                                'supertrend_ub': {'type': FLOAT, 'cn': 'supertrend upper band', 'size': 70},
                                'supertrend': {'type': FLOAT, 'cn': 'supertrend', 'size': 70},
                                'supertrend_lb': {'type': FLOAT, 'cn': 'supertrend lower band', 'size': 70},
                                'dpo': {'type': FLOAT, 'cn': 'dpo', 'size': 70},
                                'madpo': {'type': FLOAT, 'cn': 'madpo', 'size': 70},
                                'vhf': {'type': FLOAT, 'cn': 'vhf', 'size': 70},
                                'rvi': {'type': FLOAT, 'cn': 'rvi', 'size': 70},
                                'rvis': {'type': FLOAT, 'cn': 'rvis', 'size': 70},
                                'fi': {'type': FLOAT, 'cn': 'fi', 'size': 70},
                                'force_2': {'type': FLOAT, 'cn': 'force_2', 'size': 70},
                                'force_13': {'type': FLOAT, 'cn': 'force_13', 'size': 70},
                                'ene_ue': {'type': FLOAT, 'cn': 'ene upper band', 'size': 70},
                                'ene': {'type': FLOAT, 'cn': 'ene', 'size': 70},
                                'ene_le': {'type': FLOAT, 'cn': 'ene lower band', 'size': 70},
                                'stochrsi_k': {'type': FLOAT, 'cn': 'stochrsi_k', 'size': 70},
                                'stochrsi_d': {'type': FLOAT, 'cn': 'stochrsi_d', 'size': 70}}}

TABLE_CN_STOCK_INDICATORS = {'name': 'cn_stock_indicators', 'cn': 'Stock Indicator Data',
                             'columns': TABLE_CN_STOCK_FOREIGN_KEY['columns'].copy()}
TABLE_CN_STOCK_INDICATORS['columns'].update(STOCK_STATS_DATA['columns'])

_tmp_columns = TABLE_CN_STOCK_FOREIGN_KEY['columns'].copy()
_tmp_columns.update(TABLE_CN_STOCK_BACKTEST_DATA['columns'])

TABLE_CN_STOCK_INDICATORS_BUY = {'name': 'cn_stock_indicators_buy', 'cn': 'Stock Indicators Buy',
                                 'columns': _tmp_columns}

TABLE_CN_STOCK_INDICATORS_SELL = {'name': 'cn_stock_indicators_sell', 'cn': 'Stock Indicators Sell',
                                  'columns': _tmp_columns}

TABLE_CN_STOCK_STRATEGIES = [
    {'name': 'cn_stock_strategy_enter', 'cn': 'Volume Increase', 'size': 70, 'func': enter.check_volume,
     'columns': _tmp_columns},
    {'name': 'cn_stock_strategy_keep_increasing', 'cn': 'Moving Average Bullish', 'size': 70, 'func': keep_increasing.check,
     'columns': _tmp_columns},
    {'name': 'cn_stock_strategy_parking_apron', 'cn': 'Parking Apron', 'size': 70, 'func': parking_apron.check,
     'columns': _tmp_columns},
    {'name': 'cn_stock_strategy_backtrace_ma250', 'cn': 'Yearly Line Backtrace', 'size': 70, 'func': backtrace_ma250.check,
     'columns': _tmp_columns},
    {'name': 'cn_stock_strategy_breakthrough_platform', 'cn': 'Platform Breakthrough', 'size': 70,
     'func': breakthrough_platform.check,
     'columns': _tmp_columns},
    {'name': 'cn_stock_strategy_low_backtrace_increase', 'cn': 'No Major Retracement', 'size': 70,
     'func': low_backtrace_increase.check,
     'columns': _tmp_columns},
    {'name': 'cn_stock_strategy_turtle_trade', 'cn': 'Turtle Trading Rules', 'size': 70, 'func': turtle_trade.check_enter,
     'columns': _tmp_columns},
    {'name': 'cn_stock_strategy_high_tight_flag', 'cn': 'High and Tight Flag', 'size': 70,
     'func': high_tight_flag.check_high_tight,
     'columns': _tmp_columns},
    {'name': 'cn_stock_strategy_climax_limitdown', 'cn': 'Volume Decrease Limit Down', 'size': 70, 'func': climax_limitdown.check,
     'columns': _tmp_columns},
    {'name': 'cn_stock_strategy_low_atr', 'cn': 'Low ATR Growth', 'size': 70, 'func': low_atr.check_low_increase,
     'columns': _tmp_columns}
]

STOCK_KLINE_PATTERN_DATA = {'name': 'cn_stock_pattern_recognitions', 'cn': 'K-line Patterns',
                            'columns': {
                                'tow_crows': {'type': SmallInteger, 'cn': 'Two Crows', 'size': 70, 'func': tl.CDL2CROWS},
                                'upside_gap_two_crows': {'type': SmallInteger, 'cn': 'Upside Gap Two Crows', 'size': 70,
                                                         'func': tl.CDLUPSIDEGAP2CROWS},
                                'three_black_crows': {'type': SmallInteger, 'cn': 'Three Black Crows', 'size': 70,
                                                      'func': tl.CDL3BLACKCROWS},
                                'identical_three_crows': {'type': SmallInteger, 'cn': 'Identical Three Crows', 'size': 70,
                                                          'func': tl.CDLIDENTICAL3CROWS},
                                'three_line_strike': {'type': SmallInteger, 'cn': 'Three Line Strike', 'size': 70,
                                                      'func': tl.CDL3LINESTRIKE},
                                'dark_cloud_cover': {'type': SmallInteger, 'cn': 'Dark Cloud Cover', 'size': 70,
                                                     'func': tl.CDLDARKCLOUDCOVER},
                                'evening_doji_star': {'type': SmallInteger, 'cn': 'Evening Doji Star', 'size': 70,
                                                      'func': tl.CDLEVENINGDOJISTAR},
                                'doji_Star': {'type': SmallInteger, 'cn': 'Doji Star', 'size': 70, 'func': tl.CDLDOJISTAR},
                                'hanging_man': {'type': SmallInteger, 'cn': 'Hanging Man', 'size': 70,
                                                'func': tl.CDLHANGINGMAN},
                                'hikkake_pattern': {'type': SmallInteger, 'cn': 'Hikkake Pattern', 'size': 70,
                                                    'func': tl.CDLHIKKAKE},
                                'modified_hikkake_pattern': {'type': SmallInteger, 'cn': 'Modified Hikkake Pattern', 'size': 70,
                                                             'func': tl.CDLHIKKAKEMOD},
                                'in_neck_pattern': {'type': SmallInteger, 'cn': 'In Neck Pattern', 'size': 70,
                                                    'func': tl.CDLINNECK},
                                'on_neck_pattern': {'type': SmallInteger, 'cn': 'On Neck Pattern', 'size': 70,
                                                    'func': tl.CDLONNECK},
                                'thrusting_pattern': {'type': SmallInteger, 'cn': 'Thrusting Pattern', 'size': 70,
                                                      'func': tl.CDLTHRUSTING},
                                'shooting_star': {'type': SmallInteger, 'cn': 'Shooting Star', 'size': 70,
                                                  'func': tl.CDLSHOOTINGSTAR},
                                'stalled_pattern': {'type': SmallInteger, 'cn': 'Stalled Pattern', 'size': 70,
                                                    'func': tl.CDLSTALLEDPATTERN},
                                'advance_block': {'type': SmallInteger, 'cn': 'Advance Block', 'size': 70,
                                                  'func': tl.CDLADVANCEBLOCK},
                                'high_wave_candle': {'type': SmallInteger, 'cn': 'High Wave Candle', 'size': 70,
                                                     'func': tl.CDLHIGHWAVE},
                                'engulfing_pattern': {'type': SmallInteger, 'cn': 'Engulfing Pattern', 'size': 70,
                                                      'func': tl.CDLENGULFING},
                                'abandoned_baby': {'type': SmallInteger, 'cn': 'Abandoned Baby', 'size': 70,
                                                   'func': tl.CDLABANDONEDBABY},
                                'closing_marubozu': {'type': SmallInteger, 'cn': 'Closing Marubozu', 'size': 70,
                                                     'func': tl.CDLCLOSINGMARUBOZU},
                                'doji': {'type': SmallInteger, 'cn': 'Doji', 'size': 70, 'func': tl.CDLDOJI},
                                'up_down_gap': {'type': SmallInteger, 'cn': 'Upside/Downside Gap', 'size': 70,
                                                'func': tl.CDLGAPSIDESIDEWHITE},
                                'long_legged_doji': {'type': SmallInteger, 'cn': 'Long-Legged Doji', 'size': 70,
                                                     'func': tl.CDLLONGLEGGEDDOJI},
                                'rickshaw_man': {'type': SmallInteger, 'cn': 'Rickshaw Man', 'size': 70,
                                                 'func': tl.CDLRICKSHAWMAN},
                                'marubozu': {'type': SmallInteger, 'cn': 'Marubozu', 'size': 70,
                                             'func': tl.CDLMARUBOZU},
                                'three_inside_up_down': {'type': SmallInteger, 'cn': 'Three Inside Up/Down', 'size': 70,
                                                         'func': tl.CDL3INSIDE},
                                'three_outside_up_down': {'type': SmallInteger, 'cn': 'Three Outside Up/Down', 'size': 70,
                                                          'func': tl.CDL3OUTSIDE},
                                'three_stars_in_the_south': {'type': SmallInteger, 'cn': 'Three Stars in the South', 'size': 70,
                                                             'func': tl.CDL3STARSINSOUTH},
                                'three_white_soldiers': {'type': SmallInteger, 'cn': 'Three White Soldiers', 'size': 70,
                                                         'func': tl.CDL3WHITESOLDIERS},
                                'belt_hold': {'type': SmallInteger, 'cn': 'Belt Hold', 'size': 70,
                                              'func': tl.CDLBELTHOLD},
                                'breakaway': {'type': SmallInteger, 'cn': 'Breakaway', 'size': 70, 'func': tl.CDLBREAKAWAY},
                                'concealing_baby_swallow': {'type': SmallInteger, 'cn': 'Concealing Baby Swallow', 'size': 70,
                                                            'func': tl.CDLCONCEALBABYSWALL},
                                'counterattack': {'type': SmallInteger, 'cn': 'Counterattack', 'size': 70,
                                                  'func': tl.CDLCOUNTERATTACK},
                                'dragonfly_doji': {'type': SmallInteger, 'cn': 'Dragonfly Doji', 'size': 70,
                                                   'func': tl.CDLDRAGONFLYDOJI},
                                'evening_star': {'type': SmallInteger, 'cn': 'Evening Star', 'size': 70,
                                                 'func': tl.CDLEVENINGSTAR},
                                'gravestone_doji': {'type': SmallInteger, 'cn': 'Gravestone Doji', 'size': 70,
                                                    'func': tl.CDLGRAVESTONEDOJI},
                                'hammer': {'type': SmallInteger, 'cn': 'Hammer', 'size': 70, 'func': tl.CDLHAMMER},
                                'harami_pattern': {'type': SmallInteger, 'cn': 'Harami Pattern', 'size': 70,
                                                   'func': tl.CDLHARAMI},
                                'harami_cross_pattern': {'type': SmallInteger, 'cn': 'Harami Cross Pattern', 'size': 70,
                                                         'func': tl.CDLHARAMICROSS},
                                'homing_pigeon': {'type': SmallInteger, 'cn': 'Homing Pigeon', 'size': 70,
                                                  'func': tl.CDLHOMINGPIGEON},
                                'inverted_hammer': {'type': SmallInteger, 'cn': 'Inverted Hammer', 'size': 70,
                                                    'func': tl.CDLINVERTEDHAMMER},
                                'kicking': {'type': SmallInteger, 'cn': 'Kicking', 'size': 70, 'func': tl.CDLKICKING},
                                'kicking_bull_bear': {'type': SmallInteger, 'cn': 'Kicking by Length', 'size': 70,
                                                      'func': tl.CDLKICKINGBYLENGTH},
                                'ladder_bottom': {'type': SmallInteger, 'cn': 'Ladder Bottom', 'size': 70,
                                                  'func': tl.CDLLADDERBOTTOM},
                                'long_line_candle': {'type': SmallInteger, 'cn': 'Long Line Candle', 'size': 70,
                                                     'func': tl.CDLLONGLINE},
                                'matching_low': {'type': SmallInteger, 'cn': 'Matching Low', 'size': 70,
                                                 'func': tl.CDLMATCHINGLOW},
                                'mat_hold': {'type': SmallInteger, 'cn': 'Mat Hold', 'size': 70, 'func': tl.CDLMATHOLD},
                                'morning_doji_star': {'type': SmallInteger, 'cn': 'Morning Doji Star', 'size': 70,
                                                      'func': tl.CDLMORNINGDOJISTAR},
                                'morning_star': {'type': SmallInteger, 'cn': 'Morning Star', 'size': 70,
                                                 'func': tl.CDLMORNINGSTAR},
                                'piercing_pattern': {'type': SmallInteger, 'cn': 'Piercing Pattern', 'size': 70,
                                                     'func': tl.CDLPIERCING},
                                'rising_falling_three': {'type': SmallInteger, 'cn': 'Rising/Falling Three Methods', 'size': 70,
                                                         'func': tl.CDLRISEFALL3METHODS},
                                'separating_lines': {'type': SmallInteger, 'cn': 'Separating Lines', 'size': 70,
                                                     'func': tl.CDLSEPARATINGLINES},
                                'short_line_candle': {'type': SmallInteger, 'cn': 'Short Line Candle', 'size': 70,
                                                      'func': tl.CDLSHORTLINE},
                                'spinning_top': {'type': SmallInteger, 'cn': 'Spinning Top', 'size': 70,
                                                 'func': tl.CDLSPINNINGTOP},
                                'stick_sandwich': {'type': SmallInteger, 'cn': 'Stick Sandwich', 'size': 70,
                                                   'func': tl.CDLSTICKSANDWICH},
                                'takuri': {'type': SmallInteger, 'cn': 'Takuri (Testing Water)', 'size': 70, 'func': tl.CDLTAKURI},
                                'tasuki_gap': {'type': SmallInteger, 'cn': 'Tasuki Gap', 'size': 70,
                                               'func': tl.CDLTASUKIGAP},
                                'tristar_pattern': {'type': SmallInteger, 'cn': 'Tristar Pattern', 'size': 70,
                                                    'func': tl.CDLTRISTAR},
                                'unique_3_river': {'type': SmallInteger, 'cn': 'Unique 3 River', 'size': 70,
                                                   'func': tl.CDLUNIQUE3RIVER},
                                'upside_downside_gap': {'type': SmallInteger, 'cn': 'Upside/Downside Gap Three Methods', 'size': 70,
                                                        'func': tl.CDLXSIDEGAP3METHODS}}}

TABLE_CN_STOCK_KLINE_PATTERN = {'name': 'cn_stock_pattern', 'cn': 'Stock K-line Patterns',
                                'columns': TABLE_CN_STOCK_FOREIGN_KEY['columns'].copy()}
TABLE_CN_STOCK_KLINE_PATTERN['columns'].update(STOCK_KLINE_PATTERN_DATA['columns'])

TABLE_CN_STOCK_SELECTION = {'name': 'cn_stock_selection', 'cn': 'Comprehensive Stock Selection',
                            'columns': {'date': {'type': DATE, 'cn': 'Date', 'size': 0, 'map': 'MAX_TRADE_DATE'},
                                        'code': {'type': NVARCHAR(length=6), 'cn': 'Code', 'size': 60,
                                                 'map': 'SECURITY_CODE'},
                                        'name': {'type': NVARCHAR(length=20), 'cn': 'Name', 'size': 70,
                                                 'map': 'SECURITY_NAME_ABBR'},
                                        'new_price': {'type': FLOAT, 'cn': 'Latest Price', 'size': 70, 'map': 'NEW_PRICE'},
                                        'change_rate': {'type': FLOAT, 'cn': 'Change Rate', 'size': 70,
                                                        'map': 'CHANGE_RATE'},
                                        'volume_ratio': {'type': FLOAT, 'cn': 'Volume Ratio', 'size': 70,
                                                         'map': 'VOLUME_RATIO'},
                                        'high_price': {'type': FLOAT, 'cn': 'Highest Price', 'size': 70, 'map': 'HIGH_PRICE'},
                                        'low_price': {'type': FLOAT, 'cn': 'Lowest Price', 'size': 70, 'map': 'LOW_PRICE'},
                                        'pre_close_price': {'type': FLOAT, 'cn': 'Previous Close Price', 'size': 70,
                                                            'map': 'PRE_CLOSE_PRICE'},
                                        'volume': {'type': BIGINT, 'cn': 'Volume', 'size': 90, 'map': 'VOLUME'},
                                        'deal_amount': {'type': BIGINT, 'cn': 'Transaction Amount', 'size': 100,
                                                        'map': 'DEAL_AMOUNT'},
                                        'turnoverrate': {'type': FLOAT, 'cn': 'Turnover Rate', 'size': 70,
                                                         'map': 'TURNOVERRATE'},
                                        'listing_date': {'type': DATE, 'cn': 'Listing Date', 'size': 110,
                                                         'map': 'LISTING_DATE'},
                                        'industry': {'type': NVARCHAR(length=20), 'cn': 'Industry', 'size': 100,
                                                     'map': 'INDUSTRY'},
                                        'area': {'type': NVARCHAR(length=20), 'cn': 'Region', 'size': 70, 'map': 'AREA'},
                                        'concept': {'type': NVARCHAR(length=255), 'cn': 'Concept', 'size': 150,
                                                    'map': 'CONCEPT'},
                                        'style': {'type': NVARCHAR(length=255), 'cn': 'Sector', 'size': 150,
                                                  'map': 'STYLE'},
                                        'is_hs300': {'type': NVARCHAR(length=2), 'cn': 'HS300 Index', 'size': 0,
                                                     'map': 'IS_HS300'},
                                        'is_sz50': {'type': NVARCHAR(length=2), 'cn': 'SZ50 Index', 'size': 0,
                                                    'map': 'IS_SZ50'},
                                        'is_zz500': {'type': NVARCHAR(length=2), 'cn': 'ZZ500 Index', 'size': 0,
                                                     'map': 'IS_ZZ500'},
                                        'is_zz1000': {'type': NVARCHAR(length=2), 'cn': 'ZZ1000 Index', 'size': 0,
                                                      'map': 'IS_ZZ1000'},
                                        'is_cy50': {'type': NVARCHAR(length=2), 'cn': 'CY50 Index', 'size': 0,
                                                    'map': 'IS_CY50'},
                                        'pe9': {'type': FLOAT, 'cn': 'P/E Ratio (TTM)', 'size': 70, 'map': 'PE9'},
                                        'pbnewmrq': {'type': FLOAT, 'cn': 'P/B Ratio (MRQ)', 'size': 70, 'map': 'PBNEWMRQ'},
                                        'pettmdeducted': {'type': FLOAT, 'cn': 'P/E Ratio (TTM, Excluding Extraordinary Items)',
                                                          'size': 70, 'map': 'PETTMDEDUCTED'},
                                        'ps9': {'type': FLOAT, 'cn': 'P/S Ratio (TTM)', 'size': 70, 'map': 'PS9'},
                                        'pcfjyxjl9': {'type': FLOAT, 'cn': 'P/CF Ratio (TTM)', 'size': 70, 'map': 'PCFJYXJL9'},
                                        'predict_pe_syear': {'type': FLOAT, 'cn': 'Predicted P/E Ratio (This Year)', 'size': 70,
                                                             'map': 'PREDICT_PE_SYEAR'},
                                        'predict_pe_nyear': {'type': FLOAT, 'cn': 'Predicted P/E Ratio (Next Year)', 'size': 70,
                                                             'map': 'PREDICT_PE_NYEAR'},
                                        'total_market_cap': {'type': BIGINT, 'cn': 'Total Market Capitalization', 'size': 120,
                                                             'map': 'TOTAL_MARKET_CAP'},
                                        'free_cap': {'type': BIGINT, 'cn': 'Circulating Market Capitalization', 'size': 120,
                                                     'map': 'FREE_CAP'},
                                        'dtsyl': {'type': FLOAT, 'cn': 'Dynamic P/E Ratio', 'size': 70, 'map': 'DTSYL'},
                                        'ycpeg': {'type': FLOAT, 'cn': 'Predicted PEG', 'size': 70, 'map': 'YCPEG'},
                                        'enterprise_value_multiple': {'type': FLOAT, 'cn': 'Enterprise Value Multiple', 'size': 70,
                                                                      'map': 'ENTERPRISE_VALUE_MULTIPLE'},
                                        'basic_eps': {'type': FLOAT, 'cn': 'Earnings Per Share', 'size': 70, 'map': 'BASIC_EPS'},
                                        'bvps': {'type': FLOAT, 'cn': 'Book Value Per Share', 'size': 70, 'map': 'BVPS'},
                                        'per_netcash_operate': {'type': FLOAT, 'cn': 'Operating Cash Flow Per Share', 'size': 70,
                                                                'map': 'PER_NETCASH_OPERATE'},
                                        'per_fcfe': {'type': FLOAT, 'cn': 'Free Cash Flow Per Share', 'size': 70,
                                                     'map': 'PER_FCFE'},
                                        'per_capital_reserve': {'type': FLOAT, 'cn': 'Capital Reserve Per Share', 'size': 70,
                                                                'map': 'PER_CAPITAL_RESERVE'},
                                        'per_unassign_profit': {'type': FLOAT, 'cn': 'Unallocated Profit Per Share', 'size': 70,
                                                                'map': 'PER_UNASSIGN_PROFIT'},
                                        'per_surplus_reserve': {'type': FLOAT, 'cn': 'Surplus Reserve Per Share', 'size': 70,
                                                                'map': 'PER_SURPLUS_RESERVE'},
                                        'per_retained_earning': {'type': FLOAT, 'cn': 'Retained Earnings Per Share', 'size': 70,
                                                                 'map': 'PER_RETAINED_EARNING'},
                                        'parent_netprofit': {'type': BIGINT, 'cn': 'Net Profit Attributable to Parent Company',
                                                             'size': 110, 'map': 'PARENT_NETPROFIT'},
                                        'deduct_netprofit': {'type': BIGINT, 'cn': 'Net Profit Excluding Extraordinary Items',
                                                             'size': 110, 'map': 'DEDUCT_NETPROFIT'},
                                        'total_operate_income': {'type': BIGINT, 'cn': 'Total Operating Income', 'size': 120,
                                                                 'map': 'TOTAL_OPERATE_INCOME'},
                                        'roe_weight': {'type': FLOAT, 'cn': 'Return on Equity (ROE)', 'size': 70,
                                                       'map': 'ROE_WEIGHT'},
                                        'jroa': {'type': FLOAT, 'cn': 'Return on Assets (ROA)', 'size': 70, 'map': 'JROA'},
                                        'roic': {'type': FLOAT, 'cn': 'Return on Invested Capital (ROIC)', 'size': 70, 'map': 'ROIC'},
                                        'zxgxl': {'type': FLOAT, 'cn': 'Latest Dividend Yield', 'size': 70, 'map': 'ZXGXL'},
                                        'sale_gpr': {'type': FLOAT, 'cn': 'Gross Profit Margin', 'size': 70, 'map': 'SALE_GPR'},
                                        'sale_npr': {'type': FLOAT, 'cn': 'Net Profit Margin', 'size': 70, 'map': 'SALE_NPR'},
                                        'netprofit_yoy_ratio': {'type': FLOAT, 'cn': 'Net Profit Year-over-Year Growth Rate',
                                                                'size': 70, 'map': 'NETPROFIT_YOY_RATIO'},
                                        'deduct_netprofit_growthrate': {'type': FLOAT, 'cn': 'Growth Rate of Net Profit Excluding Extraordinary Items',
                                                                        'size': 70, 'map': 'DEDUCT_NETPROFIT_GROWTHRATE'},
                                        'toi_yoy_ratio': {'type': FLOAT, 'cn': 'Revenue Year-over-Year Growth Rate', 'size': 70,
                                                          'map': 'TOI_YOY_RATIO'},
                                        'netprofit_growthrate_3y': {'type': FLOAT, 'cn': 'Net Profit 3-Year CAGR', 'size': 70,
                                                                    'map': 'NETPROFIT_GROWTHRATE_3Y'},
                                        'income_growthrate_3y': {'type': FLOAT, 'cn': 'Revenue 3-Year CAGR', 'size': 70,
                                                                 'map': 'INCOME_GROWTHRATE_3Y'},
                                        'predict_netprofit_ratio': {'type': FLOAT, 'cn': 'Predicted Net Profit YoY Growth', 'size': 70,
                                                                    'map': 'PREDICT_NETPROFIT_RATIO'},
                                        'predict_income_ratio': {'type': FLOAT, 'cn': 'Predicted Revenue YoY Growth', 'size': 70,
                                                                 'map': 'PREDICT_INCOME_RATIO'},
                                        'basiceps_yoy_ratio': {'type': FLOAT, 'cn': 'EPS YoY Growth Rate', 'size': 70,
                                                               'map': 'BASICEPS_YOY_RATIO'},
                                        'total_profit_growthrate': {'type': FLOAT, 'cn': 'Total Profit YoY Growth Rate', 'size': 70,
                                                                    'map': 'TOTAL_PROFIT_GROWTHRATE'},
                                        'operate_profit_growthrate': {'type': FLOAT, 'cn': 'Operating Profit YoY Growth Rate', 'size': 70,
                                                                      'map': 'OPERATE_PROFIT_GROWTHRATE'},
                                        'debt_asset_ratio': {'type': FLOAT, 'cn': 'Debt-to-Asset Ratio', 'size': 70,
                                                             'map': 'DEBT_ASSET_RATIO'},
                                        'equity_ratio': {'type': FLOAT, 'cn': 'Equity Ratio', 'size': 70,
                                                         'map': 'EQUITY_RATIO'},
                                        'equity_multiplier': {'type': FLOAT, 'cn': 'Equity Multiplier', 'size': 70,
                                                              'map': 'EQUITY_MULTIPLIER'},
                                        'current_ratio': {'type': FLOAT, 'cn': 'Current Ratio', 'size': 70,
                                                          'map': 'CURRENT_RATIO'},
                                        'speed_ratio': {'type': FLOAT, 'cn': 'Quick Ratio', 'size': 70,
                                                        'map': 'SPEED_RATIO'},
                                        'total_shares': {'type': BIGINT, 'cn': 'Total Shares', 'size': 120,
                                                         'map': 'TOTAL_SHARES'},
                                        'free_shares': {'type': BIGINT, 'cn': 'Circulating Shares', 'size': 120,
                                                        'map': 'FREE_SHARES'},
                                        'holder_newest': {'type': BIGINT, 'cn': 'Latest Number of Shareholders', 'size': 80,
                                                          'map': 'HOLDER_NEWEST'},
                                        'holder_ratio': {'type': FLOAT, 'cn': 'Shareholder Growth Rate', 'size': 70,
                                                         'map': 'HOLDER_RATIO'},
                                        'hold_amount': {'type': FLOAT, 'cn': 'Average Holding Amount Per Shareholder', 'size': 80,
                                                        'map': 'HOLD_AMOUNT'},
                                        'avg_hold_num': {'type': FLOAT, 'cn': 'Average Holding Quantity Per Shareholder', 'size': 70,
                                                         'map': 'AVG_HOLD_NUM'},
                                        'holdnum_growthrate_3q': {'type': FLOAT, 'cn': 'Quarterly Growth Rate of Average Holding Quantity', 
                                                                  'size': 70, 'map': 'HOLDNUM_GROWTHRATE_3Q'},
                                        'holdnum_growthrate_hy': {'type': FLOAT, 'cn': 'Half-Year Growth Rate of Average Holding Quantity', 
                                                                  'size': 70, 'map': 'HOLDNUM_GROWTHRATE_HY'},
                                        'hold_ratio_count': {'type': FLOAT, 'cn': 'Total Shareholding Ratio of Top 10 Shareholders', 
                                                             'size': 70, 'map': 'HOLD_RATIO_COUNT'},
                                        'free_hold_ratio': {'type': FLOAT, 'cn': 'Total Circulating Shareholding Ratio of Top 10 Shareholders', 
                                                            'size': 70, 'map': 'FREE_HOLD_RATIO'},
                                        'macd_golden_fork': {'type': BIT, 'cn': 'MACD Golden Cross (Daily)', 'size': 70, 
                                                             'map': 'MACD_GOLDEN_FORK'},
                                        'macd_golden_forkz': {'type': BIT, 'cn': 'MACD Golden Cross (Weekly)', 'size': 70, 
                                                              'map': 'MACD_GOLDEN_FORKZ'},
                                        'macd_golden_forky': {'type': BIT, 'cn': 'MACD Golden Cross (Monthly)', 'size': 70, 
                                                              'map': 'MACD_GOLDEN_FORKY'},
                                        'kdj_golden_fork': {'type': BIT, 'cn': 'KDJ Golden Cross (Daily)', 'size': 70, 
                                                            'map': 'KDJ_GOLDEN_FORK'},
                                        'kdj_golden_forkz': {'type': BIT, 'cn': 'KDJ Golden Cross (Weekly)', 'size': 70, 
                                                             'map': 'KDJ_GOLDEN_FORKZ'},
                                        'kdj_golden_forky': {'type': BIT, 'cn': 'KDJ Golden Cross (Monthly)', 'size': 70, 
                                                             'map': 'KDJ_GOLDEN_FORKY'},
                                        'break_through': {'type': BIT, 'cn': 'Breakthrough with High Volume', 'size': 70, 
                                                          'map': 'BREAK_THROUGH'},
                                        'low_funds_inflow': {'type': BIT, 'cn': 'Low-Level Net Capital Inflow', 'size': 70, 
                                                             'map': 'LOW_FUNDS_INFLOW'},
                                        'high_funds_outflow': {'type': BIT, 'cn': 'High-Level Net Capital Outflow', 'size': 70, 
                                                               'map': 'HIGH_FUNDS_OUTFLOW'},
                                        'breakup_ma_5days': {'type': BIT, 'cn': 'Break Above 5-Day Moving Average', 'size': 70, 
                                                             'map': 'BREAKUP_MA_5DAYS'},
                                        'breakup_ma_10days': {'type': BIT, 'cn': 'Break Above 10-Day Moving Average', 'size': 70, 
                                                              'map': 'BREAKUP_MA_10DAYS'},
                                        'breakup_ma_20days': {'type': BIT, 'cn': 'Break Above 20-Day Moving Average', 'size': 70, 
                                                              'map': 'BREAKUP_MA_20DAYS'},
                                        'breakup_ma_30days': {'type': BIT, 'cn': 'Break Above 30-Day Moving Average', 'size': 70, 
                                                              'map': 'BREAKUP_MA_30DAYS'},
                                        'breakup_ma_60days': {'type': BIT, 'cn': 'Break Above 60-Day Moving Average', 'size': 70, 
                                                              'map': 'BREAKUP_MA_60DAYS'},
                                        'long_avg_array': {'type': BIT, 'cn': 'Long Moving Average Arrangement', 'size': 70, 
                                                           'map': 'LONG_AVG_ARRAY'},
                                        'short_avg_array': {'type': BIT, 'cn': 'Short Moving Average Arrangement', 'size': 70, 
                                                            'map': 'SHORT_AVG_ARRAY'},
                                        'upper_large_volume': {'type': BIT, 'cn': 'Continuous Rising with High Volume', 'size': 70, 
                                                               'map': 'UPPER_LARGE_VOLUME'},
                                        'down_narrow_volume': {'type': BIT, 'cn': 'Decline with Low Volume', 'size': 70, 
                                                               'map': 'DOWN_NARROW_VOLUME'},
                                        'one_dayang_line': {'type': BIT, 'cn': 'One Large Bullish Candle', 'size': 70, 
                                                            'map': 'ONE_DAYANG_LINE'},
                                        'two_dayang_lines': {'type': BIT, 'cn': 'Two Consecutive Large Bullish Candles', 'size': 70, 
                                                             'map': 'TWO_DAYANG_LINES'},
                                        'rise_sun': {'type': BIT, 'cn': 'Rising Sun', 'size': 70, 'map': 'RISE_SUN'},
                                        'power_fulgun': {'type': BIT, 'cn': 'Strong Bullish Pattern', 'size': 70, 
                                                         'map': 'POWER_FULGUN'},
                                        'restore_justice': {'type': BIT, 'cn': 'Cloud Disperses to See Sun', 'size': 70, 
                                                            'map': 'RESTORE_JUSTICE'},
                                        'down_7days': {'type': BIT, 'cn': 'Seven Consecutive Bearish Days', 'size': 70, 
                                                       'map': 'DOWN_7DAYS'},
                                        'upper_8days': {'type': BIT, 'cn': 'Eight Consecutive Bullish Days', 'size': 70, 
                                                        'map': 'UPPER_8DAYS'},
                                        'upper_9days': {'type': BIT, 'cn': 'Nine Consecutive Bullish Days', 'size': 70, 
                                                        'map': 'UPPER_9DAYS'},
                                        'upper_4days': {'type': BIT, 'cn': 'Four Consecutive Bullish Candles', 'size': 70, 
                                                        'map': 'UPPER_4DAYS'},
                                        'heaven_rule': {'type': BIT, 'cn': 'Heavenly Rule', 'size': 70, 
                                                        'map': 'HEAVEN_RULE'},
                                        'upside_volume': {'type': BIT, 'cn': 'High Volume Uptrend', 'size': 70, 
                                                          'map': 'UPSIDE_VOLUME'},
                                        'bearish_engulfing': {'type': BIT, 'cn': 'Bearish Engulfing', 'size': 70, 
                                                              'map': 'BEARISH_ENGULFING'},
                                        'reversing_hammer': {'type': BIT, 'cn': 'Inverted Hammer', 'size': 70, 
                                                             'map': 'REVERSING_HAMMER'},
                                        'shooting_star': {'type': BIT, 'cn': 'Shooting Star', 'size': 70, 
                                                          'map': 'SHOOTING_STAR'},
                                        'evening_star': {'type': BIT, 'cn': 'Evening Star', 'size': 70, 
                                                         'map': 'EVENING_STAR'},
                                        'first_dawn': {'type': BIT, 'cn': 'First Light of Dawn', 'size': 70, 
                                                       'map': 'FIRST_DAWN'},
                                        'pregnant': {'type': BIT, 'cn': 'Harami (Inside Bar)', 'size': 70, 
                                                     'map': 'PREGNANT'},
                                        'black_cloud_tops': {'type': BIT, 'cn': 'Dark Cloud Cover', 'size': 70, 
                                                             'map': 'BLACK_CLOUD_TOPS'},
                                        'morning_star': {'type': BIT, 'cn': 'Morning Star', 'size': 70, 
                                                         'map': 'MORNING_STAR'},
                                        'narrow_finish': {'type': BIT, 'cn': 'Consolidation with Narrow Range', 'size': 70, 
                                                          'map': 'NARROW_FINISH'},
                                        'limited_lift_f6m': {'type': BIT, 'cn': 'Restricted Stock Release in Next 6 Months', 
                                                             'size': 70, 'map': 'LIMITED_LIFT_F6M'},
                                        'limited_lift_f1y': {'type': BIT, 'cn': 'Restricted Stock Release in Next Year', 
                                                             'size': 70, 'map': 'LIMITED_LIFT_F1Y'},
                                        'limited_lift_6m': {'type': BIT, 'cn': 'Restricted Stock Release in Last 6 Months', 
                                                            'size': 70, 'map': 'LIMITED_LIFT_6M'},
                                        'limited_lift_1y': {'type': BIT, 'cn': 'Restricted Stock Release in Last Year', 
                                                            'size': 70, 'map': 'LIMITED_LIFT_1Y'},
                                        'directional_seo_1m': {'type': BIT, 'cn': 'Private Placement in Last Month', 
                                                               'size': 70, 'map': 'DIRECTIONAL_SEO_1M'},
                                        'directional_seo_3m': {'type': BIT, 'cn': 'Private Placement in Last 3 Months', 
                                                               'size': 70, 'map': 'DIRECTIONAL_SEO_3M'},
                                        'directional_seo_6m': {'type': BIT, 'cn': 'Private Placement in Last 6 Months', 
                                                               'size': 70, 'map': 'DIRECTIONAL_SEO_6M'},
                                        'directional_seo_1y': {'type': BIT, 'cn': 'Private Placement in Last Year', 
                                                               'size': 70, 'map': 'DIRECTIONAL_SEO_1Y'},
                                        'recapitalize_1m': {'type': BIT, 'cn': 'Asset Restructuring in Last Month', 
                                                            'size': 70, 'map': 'RECAPITALIZE_1M'},
                                        'recapitalize_3m': {'type': BIT, 'cn': 'Asset Restructuring in Last 3 Months', 
                                                            'size': 70, 'map': 'RECAPITALIZE_3M'},
                                        'recapitalize_6m': {'type': BIT, 'cn': 'Asset Restructuring in Last 6 Months', 
                                                            'size': 70, 'map': 'RECAPITALIZE_6M'},
                                        'recapitalize_1y': {'type': BIT, 'cn': 'Asset Restructuring in Last Year', 
                                                            'size': 70, 'map': 'RECAPITALIZE_1Y'},
                                        'equity_pledge_1m': {'type': BIT, 'cn': 'Equity Pledge in Last Month', 'size': 70, 
                                                             'map': 'EQUITY_PLEDGE_1M'},
                                        'equity_pledge_3m': {'type': BIT, 'cn': 'Equity Pledge in Last 3 Months', 'size': 70, 
                                                             'map': 'EQUITY_PLEDGE_3M'},
                                        'equity_pledge_6m': {'type': BIT, 'cn': 'Equity Pledge in Last 6 Months', 'size': 70, 
                                                             'map': 'EQUITY_PLEDGE_6M'},
                                        'equity_pledge_1y': {'type': BIT, 'cn': 'Equity Pledge in Last Year', 'size': 70, 
                                                             'map': 'EQUITY_PLEDGE_1Y'},
                                        'pledge_ratio': {'type': FLOAT, 'cn': 'Equity Pledge Ratio', 'size': 70, 
                                                         'map': 'PLEDGE_RATIO'},
                                        'goodwill_scale': {'type': BIGINT, 'cn': 'Goodwill Scale', 'size': 110, 
                                                           'map': 'GOODWILL_SCALE'},
                                        'goodwill_assets_ratro': {'type': FLOAT, 'cn': 'Goodwill-to-Net Assets Ratio', 'size': 70, 
                                                                  'map': 'GOODWILL_ASSETS_RATRO'},
                                        'predict_type': {'type': NVARCHAR(length=10), 'cn': 'Earnings Forecast Type', 'size': 70, 
                                                         'map': 'PREDICT_TYPE'},
                                        'par_dividend_pretax': {'type': FLOAT, 'cn': 'Dividend per Share (Pre-Tax)', 'size': 70, 
                                                                'map': 'PAR_DIVIDEND_PRETAX'},
                                        'par_dividend': {'type': FLOAT, 'cn': 'Bonus Share per Share', 'size': 70, 
                                                         'map': 'PAR_DIVIDEND'},
                                        'par_it_equity': {'type': FLOAT, 'cn': 'Per Share Capital Increase from Reserve', 'size': 70, 
                                                          'map': 'PAR_IT_EQUITY'},
                                        'holder_change_3m': {'type': FLOAT, 'cn': 'Shareholder Change in Last 3 Months', 'size': 70, 
                                                             'map': 'HOLDER_CHANGE_3M'},
                                        'executive_change_3m': {'type': FLOAT, 'cn': 'Executive Change in Last 3 Months', 'size': 70, 
                                                                'map': 'EXECUTIVE_CHANGE_3M'},
                                        'org_survey_3m': {'type': SmallInteger, 'cn': 'Institutional Surveys in Last 3 Months', 'size': 70, 
                                                          'map': 'ORG_SURVEY_3M'},
                                        'org_rating': {'type': NVARCHAR(length=10), 'cn': 'Institutional Rating', 'size': 70, 
                                                       'map': 'ORG_RATING'},
                                        'allcorp_num': {'type': SmallInteger, 'cn': 'Total Institutions Holding Shares', 'size': 70, 
                                                        'map': 'ALLCORP_NUM'},
                                        'allcorp_fund_num': {'type': SmallInteger, 'cn': 'Number of Funds Holding Shares', 'size': 70, 
                                                             'map': 'ALLCORP_FUND_NUM'},
                                        'allcorp_qs_num': {'type': SmallInteger, 'cn': 'Number of Brokerages Holding Shares', 'size': 70, 
                                                           'map': 'ALLCORP_QS_NUM'},
                                        'allcorp_qfii_num': {'type': SmallInteger, 'cn': 'Number of QFII Institutions Holding Shares', 'size': 70, 
                                                             'map': 'ALLCORP_QFII_NUM'},
                                        'allcorp_bx_num': {'type': SmallInteger, 'cn': 'Number of Insurance Companies Holding Shares', 'size': 70, 
                                                           'map': 'ALLCORP_BX_NUM'},
                                        'allcorp_sb_num': {'type': SmallInteger, 'cn': 'Number of Social Security Funds Holding Shares', 'size': 70, 
                                                           'map': 'ALLCORP_SB_NUM'},
                                        'allcorp_xt_num': {'type': SmallInteger, 'cn': 'Number of Trust Companies Holding Shares', 'size': 70, 
                                                           'map': 'ALLCORP_XT_NUM'},
                                        'allcorp_ratio': {'type': FLOAT, 'cn': 'Total Shareholding Ratio of Institutions', 'size': 70, 
                                                          'map': 'ALLCORP_RATIO'},
                                        'allcorp_fund_ratio': {'type': FLOAT, 'cn': 'Shareholding Ratio of Funds', 'size': 70, 
                                                               'map': 'ALLCORP_FUND_RATIO'},
                                        'allcorp_qs_ratio': {'type': FLOAT, 'cn': 'Shareholding Ratio of Brokerages', 'size': 70, 
                                                             'map': 'ALLCORP_QS_RATIO'},
                                        'allcorp_qfii_ratio': {'type': FLOAT, 'cn': 'Shareholding Ratio of QFII', 'size': 70, 
                                                               'map': 'ALLCORP_QFII_RATIO'},
                                        'allcorp_bx_ratio': {'type': FLOAT, 'cn': 'Shareholding Ratio of Insurance Companies', 'size': 70, 
                                                             'map': 'ALLCORP_BX_RATIO'},
                                        'allcorp_sb_ratio': {'type': FLOAT, 'cn': 'Shareholding Ratio of Social Security Funds', 'size': 70, 
                                                             'map': 'ALLCORP_SB_RATIO'},
                                        'allcorp_xt_ratio': {'type': FLOAT, 'cn': 'Shareholding Ratio of Trust Companies', 'size': 70, 
                                                             'map': 'ALLCORP_XT_RATIO'},
                                        'popularity_rank': {'type': SmallInteger, 'cn': 'Popularity Rank in Stock Forums', 'size': 70, 
                                                            'map': 'POPULARITY_RANK'},
                                        'rank_change': {'type': SmallInteger, 'cn': 'Popularity Rank Change', 'size': 70, 
                                                        'map': 'RANK_CHANGE'},
                                        'upp_days': {'type': SmallInteger, 'cn': 'Consecutive Popularity Increase Days', 'size': 70, 
                                                     'map': 'UPP_DAYS'},
                                        'down_days': {'type': SmallInteger, 'cn': 'Consecutive Popularity Decrease Days', 'size': 70, 
                                                      'map': 'DOWN_DAYS'},
                                        'new_high': {'type': SmallInteger, 'cn': 'New High Popularity Rank', 'size': 70, 
                                                     'map': 'NEW_HIGH'},
                                        'new_down': {'type': SmallInteger, 'cn': 'New Low Popularity Rank', 'size': 70, 
                                                     'map': 'NEW_DOWN'},
                                        'newfans_ratio': {'type': FLOAT, 'cn': 'New Fans Ratio', 'size': 70, 
                                                          'map': 'NEWFANS_RATIO'},
                                        'bigfans_ratio': {'type': FLOAT, 'cn': 'Loyal Fans Ratio', 'size': 70, 
                                                          'map': 'BIGFANS_RATIO'},
                                        'concern_rank_7days': {'type': SmallInteger, 'cn': '7-Day Attention Rank', 'size': 70, 
                                                               'map': 'CONCERN_RANK_7DAYS'},
                                        'browse_rank': {'type': SmallInteger, 'cn': 'Today’s Browse Rank', 'size': 70, 'map': 'BROWSE_RANK'},
                                        'amplitude': {'type': FLOAT, 'cn': 'Amplitude', 'size': 70, 'map': 'AMPLITUDE'},
                                        'is_issue_break': {'type': BIT, 'cn': 'IPO Break Stock', 'size': 70, 'map': 'IS_ISSUE_BREAK'},
                                        'is_bps_break': {'type': BIT, 'cn': 'BPS Break Stock', 'size': 70, 'map': 'IS_BPS_BREAK'},
                                        'now_newhigh': {'type': BIT, 'cn': 'Today’s All-Time High', 'size': 70, 'map': 'NOW_NEWHIGH'},
                                        'now_newlow': {'type': BIT, 'cn': 'Today’s All-Time Low', 'size': 70, 'map': 'NOW_NEWLOW'},
                                        'high_recent_3days': {'type': BIT, 'cn': 'Recent All-Time High (3 Days)', 'size': 70, 'map': 'HIGH_RECENT_3DAYS'},
                                        'high_recent_5days': {'type': BIT, 'cn': 'Recent All-Time High (5 Days)', 'size': 70, 'map': 'HIGH_RECENT_5DAYS'},
                                        'high_recent_10days': {'type': BIT, 'cn': 'Recent All-Time High (10 Days)', 'size': 70, 'map': 'HIGH_RECENT_10DAYS'},
                                        'high_recent_20days': {'type': BIT, 'cn': 'Recent All-Time High (20 Days)', 'size': 70, 'map': 'HIGH_RECENT_20DAYS'},
                                        'high_recent_30days': {'type': BIT, 'cn': 'Recent All-Time High (30 Days)', 'size': 70, 'map': 'HIGH_RECENT_30DAYS'},
                                        'low_recent_3days': {'type': BIT, 'cn': 'Recent All-Time Low (3 Days)', 'size': 70, 'map': 'LOW_RECENT_3DAYS'},
                                        'low_recent_5days': {'type': BIT, 'cn': 'Recent All-Time Low (5 Days)', 'size': 70, 'map': 'LOW_RECENT_5DAYS'},
                                        'low_recent_10days': {'type': BIT, 'cn': 'Recent All-Time Low (10 Days)', 'size': 70, 'map': 'LOW_RECENT_10DAYS'},
                                        'low_recent_20days': {'type': BIT, 'cn': 'Recent All-Time Low (20 Days)', 'size': 70, 'map': 'LOW_RECENT_20DAYS'},
                                        'low_recent_30days': {'type': BIT, 'cn': 'Recent All-Time Low (30 Days)', 'size': 70, 'map': 'LOW_RECENT_30DAYS'},
                                        'win_market_3days': {'type': BIT, 'cn': 'Outperformed Market (3 Days)', 'size': 70, 'map': 'WIN_MARKET_3DAYS'},
                                        'win_market_5days': {'type': BIT, 'cn': 'Outperformed Market (5 Days)', 'size': 70, 'map': 'WIN_MARKET_5DAYS'},
                                        'win_market_10days': {'type': BIT, 'cn': 'Outperformed Market (10 Days)', 'size': 70, 'map': 'WIN_MARKET_10DAYS'},
                                        'win_market_20days': {'type': BIT, 'cn': 'Outperformed Market (20 Days)', 'size': 70, 'map': 'WIN_MARKET_20DAYS'},
                                        'win_market_30days': {'type': BIT, 'cn': 'Outperformed Market (30 Days)', 'size': 70, 'map': 'WIN_MARKET_30DAYS'},
                                        'net_inflow': {'type': FLOAT, 'cn': 'Net Inflow Today', 'size': 110, 'map': 'NET_INFLOW'},
                                        'netinflow_3days': {'type': BIGINT, 'cn': 'Net Inflow (3 Days)', 'size': 110, 'map': 'NETINFLOW_3DAYS'},
                                        'netinflow_5days': {'type': BIGINT, 'cn': 'Net Inflow (5 Days)', 'size': 110, 'map': 'NETINFLOW_5DAYS'},
                                        'nowinterst_ratio': {'type': BIGINT, 'cn': 'Position Increase Ratio Today', 'size': 70, 'map': 'NOWINTERST_RATIO'},
                                        'nowinterst_ratio_3d': {'type': FLOAT, 'cn': 'Position Increase Ratio (3 Days)', 'size': 70, 'map': 'NOWINTERST_RATIO_3D'},
                                        'nowinterst_ratio_5d': {'type': FLOAT, 'cn': 'Position Increase Ratio (5 Days)', 'size': 70, 'map': 'NOWINTERST_RATIO_5D'},
                                        'ddx': {'type': FLOAT, 'cn': 'DDX Today', 'size': 70, 'map': 'DDX'},
                                        'ddx_3d': {'type': FLOAT, 'cn': 'DDX (3 Days)', 'size': 70, 'map': 'DDX_3D'},
                                        'ddx_5d': {'type': FLOAT, 'cn': 'DDX (5 Days)', 'size': 70, 'map': 'DDX_5D'},
                                        'ddx_red_10d': {'type': SmallInteger, 'cn': 'DDX Positive Days (10 Days)', 'size': 70, 'map': 'DDX_RED_10D'},
                                        'changerate_3days': {'type': FLOAT, 'cn': 'Change Rate (3 Days)', 'size': 70, 'map': 'CHANGERATE_3DAYS'},
                                        'changerate_5days': {'type': FLOAT, 'cn': 'Change Rate (5 Days)', 'size': 70, 'map': 'CHANGERATE_5DAYS'},
                                        'changerate_10days': {'type': FLOAT, 'cn': 'Change Rate (10 Days)', 'size': 70, 'map': 'CHANGERATE_10DAYS'},
                                        'changerate_ty': {'type': FLOAT, 'cn': 'Change Rate Year-To-Date', 'size': 70, 'map': 'CHANGERATE_TY'},
                                        'upnday': {'type': SmallInteger, 'cn': 'Consecutive Increase Days', 'size': 70, 'map': 'UPNDAY'},
                                        'downnday': {'type': SmallInteger, 'cn': 'Consecutive Decrease Days', 'size': 70, 'map': 'DOWNNDAY'},
                                        'listing_yield_year': {'type': FLOAT, 'cn': 'Annualized Yield Since Listing', 'size': 70, 'map': 'LISTING_YIELD_YEAR'},
                                        'listing_volatility_year': {'type': FLOAT, 'cn': 'Annualized Volatility Since Listing', 'size': 70, 'map': 'LISTING_VOLATILITY_YEAR'},
                                        'mutual_netbuy_amt': {'type': BIGINT, 'cn': 'Net Purchase Amount (Northbound)', 'size': 90, 'map': 'MUTUAL_NETBUY_AMT'},
                                        'hold_ratio': {'type': FLOAT, 'cn': 'Holding Ratio (Northbound)', 'size': 70, 'map': 'HOLD_RATIO'},
                                        'secucode': {'type': NVARCHAR(length=10), 'cn': 'Full Code', 'size': 0, 'map': 'SECUCODE'}

                                    }
                                }


CN_STOCK_CPBD = {
    'name': 'cn_stock_cpbd',
    'cn': 'Stock Must-Read',
    'columns': {
        'SECURITY_CODE': {'type': NVARCHAR(6), 'cn': 'Code'},
        'SECURITY_NAME_ABBR': {'type': NVARCHAR(20), 'cn': 'Name'},
        'PE_DYNAMIC': {'type': FLOAT, 'cn': 'Dynamic P/E Ratio'},
        'PE_TTM': {'type': FLOAT, 'cn': 'P/E Ratio (TTM)'},
        'PE_STATIC': {'type': FLOAT, 'cn': 'Static P/E Ratio'},
        'PB_MRQ_REALTIME': {'type': FLOAT, 'cn': 'P/B Ratio'},
        'REPORT_DATE': {'type': DATE, 'cn': 'Financial Report Date'},
        'EPSJB': {'type': FLOAT, 'cn': 'Earnings per Share'},
        'BPS': {'type': FLOAT, 'cn': 'Book Value per Share'},
        'MGJYXJJE': {'type': FLOAT, 'cn': 'Operating Cash Flow per Share'},
        'MGZBGJ': {'type': FLOAT, 'cn': 'Capital Reserve per Share'},
        'MGWFPLR': {'type': FLOAT, 'cn': 'Undistributed Profit per Share'},
        'ROEJQ': {'type': FLOAT, 'cn': 'Weighted ROE'},
        'XSMLL': {'type': FLOAT, 'cn': 'Gross Profit Margin'},
        'ZCFZL': {'type': FLOAT, 'cn': 'Debt-to-Asset Ratio'},
        'TOTAL_OPERATEINCOME': {'type': FLOAT, 'cn': 'Total Operating Income'},
        'YYZSRGDHBZC': {'type': FLOAT, 'cn': 'Operating Income Rolling QoQ Growth'},
        'TOTALOPERATEREVETZ': {'type': FLOAT, 'cn': 'Operating Income YoY Growth'},
        'PARENT_NETPROFIT': {'type': FLOAT, 'cn': 'Net Profit Attributable to Parent'},
        'NETPROFITRPHBZC': {'type': FLOAT, 'cn': 'Net Profit Rolling QoQ Growth'},
        'PARENTNETPROFITTZ': {'type': FLOAT, 'cn': 'Net Profit YoY Growth'},
        'KCFJCXSYJLR': {'type': FLOAT, 'cn': 'Non-recurring Net Profit'},
        'KFJLRGDHBZC': {'type': FLOAT, 'cn': 'Non-recurring Net Profit Rolling QoQ Growth'},
        'KCFJCXSYJLRTZ': {'type': FLOAT, 'cn': 'Non-recurring Net Profit YoY Growth'},
        'TOTAL_SHARE': {'type': FLOAT, 'cn': 'Total Shares'},
        'FREE_SHARE': {'type': FLOAT, 'cn': 'Free Float Shares'},
        'BOARD_NAME': {'type': NVARCHAR(20), 'cn': 'Sector'},
        'END_DATE': {'type': DATE, 'cn': 'Shareholder Date'},
        'HOLDER_TOTAL_NUM': {'type': FLOAT, 'cn': 'Number of Shareholders'},
        'TOTAL_NUM_RATIO': {'type': FLOAT, 'cn': 'Change from Previous Period'},
        'AVG_FREE_SHARES': {'type': FLOAT, 'cn': 'Average Free Float Shares per Holder'},
        'AVG_FREESHARES_RATIO': {'type': FLOAT, 'cn': 'Change in Average Free Float Shares'},
        'HOLD_FOCUS': {'type': FLOAT, 'cn': 'Share Concentration'},
        'AVG_HOLD_AMT': {'type': FLOAT, 'cn': 'Average Holding Amount per Shareholder'},
        'HOLD_RATIO_TOTAL': {'type': FLOAT, 'cn': 'Top 10 Shareholders Holding Ratio'},
        'FREEHOLD_RATIO_TOTAL': {'type': FLOAT, 'cn': 'Top 10 Free Float Shareholders Holding Ratio'},
        'LHBD_DATE': {'type': DATE, 'cn': 'Dragon-Tiger List Date'},
        'EXPLANATION': {'type': FLOAT, 'cn': 'Dragon-Tiger List Explanation'},
        'TOTAL_BUY': {'type': FLOAT, 'cn': 'Total Buy Amount'},
        'TOTAL_BUYRIOTOP': {'type': FLOAT, 'cn': 'Buy Ratio'},
        'TOTAL_SELL': {'type': FLOAT, 'cn': 'Total Sell Amount'},
        'TOTAL_SELLRIOTOP': {'type': FLOAT, 'cn': 'Sell Ratio'},
        'DZJY_DATE': {'type': DATE, 'cn': 'Block Trade Date'},
        'DEAL_PRICE': {'type': FLOAT, 'cn': 'Transaction Price'},
        'PREMIUM_RATIO': {'type': FLOAT, 'cn': 'Premium Ratio'},
        'DEAL_VOLUME': {'type': FLOAT, 'cn': 'Transaction Volume'},
        'DEAL_AMT': {'type': FLOAT, 'cn': 'Transaction Amount'},
        'BUYER_NAME': {'type': FLOAT, 'cn': 'Buyer Institution'},
        'SELLER_NAME': {'type': FLOAT, 'cn': 'Seller Institution'},
        'RZRQ_DATE': {'type': DATE, 'cn': 'Margin Trading Date'},
        'FIN_BUY_AMT': {'type': FLOAT, 'cn': 'Margin Purchase Amount'},
        'FIN_REPAY_AMT': {'type': FLOAT, 'cn': 'Margin Repayment Amount'},
        'FIN_BALANCE': {'type': FLOAT, 'cn': 'Margin Balance'},
        'LOAN_SELL_VOL': {'type': FLOAT, 'cn': 'Short Selling Volume'},
        'LOAN_REPAY_VOL': {'type': FLOAT, 'cn': 'Short Selling Repayment Volume'},
        'LOAN_BALANCE': {'type': FLOAT, 'cn': 'Short Selling Balance'}
    }
}



def get_field_cn(key, table):
    f = table.get('columns').get(key)
    if f is None:
        return key
    return f.get('cn')


def get_field_cns(cols):
    data = []
    for k in cols:
        if k == 'code':
            data.append({"value": k, "caption": cols[k]['cn'], "width": cols[k]['size'],
                         "headerStyle": {"font": "bold 9pt Calibri", "wordWrap": "true"}, "style": ""})
        elif k == 'change_rate':
            data.append({"value": k, "caption": cols[k]['cn'], "width": cols[k]['size'],
                         "headerStyle": {"font": "bold 9pt Calibri", "wordWrap": "true"}, "conditionalFormats": [
                    {"ruleType": "formulaRule", "formula": "@>0", "style": {"foreColor": "red"}},
                    {"ruleType": "formulaRule", "formula": "@<0", "style": {"foreColor": "green"}}]})
        else:
            data.append({"value": k, "caption": cols[k]['cn'], "width": cols[k]['size'],
                         "headerStyle": {"font": "bold 9pt Calibri", "wordWrap": "true"}})
        # data.append({"value": k, "caption": cols[k]['cn'], "width": cols[k]['size'], "headerStyle": {"font": "bold 9pt Calibri", "wordWrap": "true"}})
        # data.append({"name": k, "displayName": cols[k]['cn'], "size": cols[k]['size']})
    return data


def get_field_types(cols):
    data = {}
    for k in cols:
        data[k] = cols[k]['type']
    return data


def get_field_type_name(col_type):
    if col_type == DATE:
        return "datetime"
    elif col_type == FLOAT or col_type == BIGINT or col_type == SmallInteger or col_type == BIT:
        return "numeric"
    else:
        return "string"
